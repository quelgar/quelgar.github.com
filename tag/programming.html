<!DOCTYPE html>
<html lang="en">
<head>
        <title>Wisdom Eludes Me - programming</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
                <link href="http://quelgar.github.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Wisdom Eludes Me Atom Feed" />
                
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
                <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../">Wisdom Eludes Me </a></h1>
                <nav><ul>
                                                                                                    <li ><a href="../category/politics.html">politics</a></li>
                                    <li ><a href="../category/programming.html">programming</a></li>
                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="../deploying-a-play-application-on-ubuntu.html">Deploying a Play Application on&nbsp;Ubuntu</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2013-03-28T00:00:00">
                Thu 28 March 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/scala.html">scala</a><a href="../tag/programming.html">programming</a><a href="../tag/play.html">play</a></p>
</footer><!-- /.post-info --><p>The more I use the <a href="http://www.playframework.com">Play Web Framework</a>, the more I like it. The &#8220;dev mode&#8221; is great, compiling everything that&#8217;s changed on the fly, including the statically checked routes and templates. But sooner or later we want to deploy our app for&nbsp;reals.</p>
<p>The <code>dist</code> target will package up your app into a zip file with a simple shell script to launch it. That&#8217;s fine as far as it goes, but of course I want to run it as a proper service that starts automatically when the machine boots and can be easily shutdown and restarted. My production <span class="caps">OS</span> of choice is Ubuntu. Let&#8217;s do&nbsp;this.</p>
<h1>Upstart</h1>
<p>I only learned about <a href="http://upstart.ubuntu.com">Upstart</a> recently while researching this problem. It&#8217;s essentially an improved version of the traditional System V init system. This discovery made me very glad I chose Ubuntu, as Upstart is both powerful and remarkably simple to use once you know the basics. The <a href="http://upstart.ubuntu.com/cookbook/">Upstart &#8220;cookbook&#8221;</a> might look a bit intimidating at first, but after a bit of playing around I found it was quite simple to do what I&nbsp;wanted.</p>
<p>By the way, Ubuntu still has the traditional System V init thing as well. I was happily using that for ages without any idea that it had a whole other more advanced init system controlling it. This is because Debian still uses the System V init by default, so all Debian packages use System V, and Ubuntu doesn&#8217;t want to re-do all that&nbsp;work.</p>
<h1>Steps</h1>
<p>This is how I got my Play server running with Upstart. This was all done on Ubuntu 12.10 and seems to be working well so far. Obviously, there are a number of choices I&#8217;ve made that could be made differently, so this is not the only way to do&nbsp;it.</p>
<h2>1. System user for&nbsp;Play</h2>
<p>I wanted a user dedicated to running Play servers.&nbsp;Easy:</p>
<div class="codehilite"><pre><span class="gp">$</span> sudo adduser --system play
</pre></div>


<h2>2. Unzip your Play&nbsp;app</h2>
<p>Just unzip your Play app somewhere. For this explanation, I&#8217;m going to assume it&#8217;s unzipped to <code>/play/myapp-1.0</code>.</p>
<p>The <code>play</code> user will need to be able to write to the app&#8217;s&nbsp;directories:</p>
<div class="codehilite"><pre><span class="gp">$</span> sudo chown -R play:adm /play/myapp-1.0
</pre></div>


<h2>3. Create an Upstart configuration&nbsp;file</h2>
<p>All Upstart &#8220;jobs&#8221; are defined by a file in <code>/etc/init</code> named <code>jobname.conf</code>. The &#8220;jobname&#8221; bit is what you call the job when starting it or checking its status or whatever. So let&#8217;s create a file <code>/etc/init/myapp.conf</code> as&nbsp;follows:</p>
<div class="codehilite"><pre># Upstart configuration for myapp Play application

description &quot;Magellan Config Server&quot;

start on runlevel [2345]
stop on runlevel [!2345]

setuid play

console log

env PLAY_DIR=/play/myapp-1.0
env JAVA_HOME=/usr/lib/jvm/jre1.7.0_17

exec $JAVA_HOME/bin/java -Dhttp.port=9001 -classpath $PLAY_DIR/lib/\* play.core.server.NettyServer $PLAY_DIR
</pre></div>


<p>All this stuff (known as <em>stanzas</em>) is described in the above mentioned Upstart cookbook, but I&#8217;ll go through it&nbsp;briefly.</p>
<p>The <code>start on</code>/<code>stop on</code> lines indicate that these actions are triggered by changes in the system&#8217;s runlevel. Upstart uses runlevels just like System V, and on Ubuntu levels 2 through 5 are all the same. There are many events that can be used to trigger start and stop, but for a standalone daemon process, these do the&nbsp;job.</p>
<p>The <code>setuid</code> stanza means the job will be executed as the specified user instead of root. This seems like a simple thing, but you&#8217;d be amazed how fiddly it can be to do this via traditional means if you need to pass environment variables&nbsp;through.</p>
<p>The <code>console log</code> stanza means that stdout and stderr are redirected to <code>/var/log/upstart/myapp.log</code>. This was useful when debugging why my job wasn&#8217;t starting. I&#8217;m going to change it to <code>console none</code> on my server as I no longer need this&nbsp;log.</p>
<p>I&#8217;m just using the <code>env</code> stanzas to break out the path settings. There&#8217;s seems to be a whole lot more they can be used for in Upstart, but I haven&#8217;t needed to worry about that&nbsp;yet.</p>
<p>The <code>exec</code> stanza specifies the command to run to run the job. This is basically the command from the <code>start</code> script that Play provides for us. I&#8217;ve just replaced the explicit listing of all the jars with the newer classpath wildcard feature, and specified the port for Play to&nbsp;use.</p>
<h2>4. Start&nbsp;it</h2>
<p>Upstart jobs are controlled by the <code>initctl</code> command. But there are various alias commands to save some typing. For example, <code>sudo start foo</code> is the same as <code>sudo initctl start foo</code>. So, let&#8217;s start our Play&nbsp;app:</p>
<div class="codehilite"><pre><span class="gp">$</span> sudo start myapp
</pre></div>


<p>Hopefully, you&#8217;ll be rewarded&nbsp;with:</p>
<div class="codehilite"><pre>myapp start/running, process 1234
</pre></div>


<p>You can confirm&nbsp;with:</p>
<div class="codehilite"><pre><span class="gp">$</span> ps -p 1234
</pre></div>


<p>If something went wrong, check <code>/var/log/upstart/myapp.log</code> for&nbsp;clues.</p>
<p>Some other&nbsp;commands:</p>
<div class="codehilite"><pre><span class="gp">$</span> sudo status myapp
<span class="gp">$</span> sudo stop myapp
<span class="gp">$</span> sudo restart myapp
<span class="gp">$</span> sudo initctl list  <span class="c"># list all Upstart jobs</span>
</pre></div>


<h1>Port&nbsp;80</h1>
<p>Of course, we like our <span class="caps">HTTP</span> servers to use port 80 (and or 443). There are a few ways this can be arranged, here&#8217;s the ones I know&nbsp;of:</p>
<ul>
<li>Run as root (don&#8217;t do&nbsp;this)</li>
<li>Redirect port 80 using the&nbsp;firewall</li>
<li>Use <a href="http://en.wikipedia.org/wiki/Authbind">authbind(1)</a></li>
<li>Use a <span class="caps">HTTP</span> reverse proxy. I&#8217;m experimenting with <a href="http://nginx.org">nginx</a></li>
</ul>
<p>I&#8217;ve used authbind, it&#8217;s pretty straight-forward and works with the <span class="caps">JVM</span>. It&#8217;s good when you just have a single server that you want on port&nbsp;80/443.</p>
<p>As Play apps run standalone with their own embedded Netty web server, an <span class="caps">HTTP</span> reverse proxy seems like it will prove quite useful. If you have a bunch of Play apps using different ports, you can use the proxy to make them all appear as part of a single &#8220;server&#8221; on port 80 (distinguished by something like a path in the <span class="caps">URL</span> or by the <span class="caps">HTTP</span> &#8220;host&#8221; header). Nginx (pronounced &#8220;Engine-X&#8221;) can also do simple load balancing, which should allow us to leverage Play&#8217;s stateless style. I&#8217;m still experimenting with these features at this&nbsp;stage.</p>
<h1>Conclusion</h1>
<p>I was pleasantly surprised at how easy it was to get my Play app up and running as an Ubuntu service. I had to spend some time learning Upstart, but it was well worth it. Upstart takes care housekeeping such as tracking the service&#8217;s <span class="caps">PID</span> for you. Compare the short configuration file above to the System V script included with Ubuntu&#8217;s Tomcat 7 package, which weighs in at 296&nbsp;lines!</p><p>There are <a href="../deploying-a-play-application-on-ubuntu.html#disqus_thread">comments</a>.</p>                </article>
                            </aside><!-- /#featured -->
                            <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
                                                

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../do-you-get-referential-transparency.html" rel="bookmark"
                           title="Permalink to Do You Get Referential Transparency?">Do You Get Referential&nbsp;Transparency?</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-07-15T00:00:00">
                Sun 15 July 2012
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/scala.html">scala</a><a href="../tag/programming.html">programming</a></p>
</footer><!-- /.post-info -->                <p>Do you get referential transparency? I mean, really <em>get</em> it? I thought I did, but I recently gained a deeper appreciation for what it&nbsp;means.</p>
<p>Referential transparency is also commonly referred to as &#8220;pure&#8221; functional programming. I understood this to mean that the code lacked side effects like performing I/O or mutating state, and this seems to be a common understanding. But referential transparency can actually be defined quite precisely and succinctly (although I believe agreement with this definition would be far from&nbsp;universal):</p>
<blockquote>
<p>If replacing expression x by its value produces the same behaviour, then x is referentially ...</p></blockquote>
                <a class="readmore" href="../do-you-get-referential-transparency.html">read more</a>
                <p>There are <a href="../do-you-get-referential-transparency.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../applying-applicative-functors-in-scala.html" rel="bookmark"
                           title="Permalink to Applying Applicative Functors in Scala">Applying Applicative Functors in&nbsp;Scala</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2011-09-02T00:00:00">
                Fri 02 September 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/scala.html">scala</a><a href="../tag/programming.html">programming</a></p>
</footer><!-- /.post-info -->                <p>A chap named ittayd has written a nice <a href="http://www.tikalk.com/incubator/blog/functional-programming-scala-rest-us">gentle tutorial on functional programming in Scala</a>. My only minor complaint is that he calls the applicative functor &#8220;sequential application&#8221; function <code>apply</code>. While this is a logical choice, in Scala <code>apply</code> is used everywhere to implement plain old function application, so it could lead to confusion. I think it&#8217;s better to call it <code>&lt;*&gt;</code>, as in Haskell. Read&nbsp;on.</p>
<p>I found the tutorial interesting because it talks a bit about applicative functors, and how to give them a nice syntax in Scala. The one thing that has bugged me about applicatives is ...</p>
                <a class="readmore" href="../applying-applicative-functors-in-scala.html">read more</a>
                <p>There are <a href="../applying-applicative-functors-in-scala.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../a-variation-on-scalas-either-type.html" rel="bookmark"
                           title="Permalink to A Variation on Scala’s Either Type">A Variation on Scala&#8217;s Either&nbsp;Type</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2011-05-03T00:00:00">
                Tue 03 May 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/scala.html">scala</a><a href="../tag/programming.html">programming</a></p>
</footer><!-- /.post-info -->                <p>I&#8217;ve been using Scala&#8217;s <code>Either</code> type a bit recently, and found a
couple of minor annoyances with it. So as a learning exercise I tried to
make a variation of <code>Either</code>, and this is what I came up with. I also
wanted to experiment with syntax a little. See what you&nbsp;think.</p>
<p><code>Either</code> is a disjunctive type with two possible values: a <em>left</em> and a <em>right</em>.
It places no meaning at all on left or right, but 99% of its uses in practice
involve putting normal, expected values in right, and errors or other
&#8220;exceptional&#8221; values in left ...</p>
                <a class="readmore" href="../a-variation-on-scalas-either-type.html">read more</a>
                <p>There are <a href="../a-variation-on-scalas-either-type.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../scalas-missing-monad.html" rel="bookmark"
                           title="Permalink to Scala’s Missing Monad">Scala&#8217;s Missing&nbsp;Monad</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-09-30T00:00:00">
                Thu 30 September 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/programming.html">programming</a><a href="../tag/scala.html">scala</a><a href="../tag/haskell.html">haskell</a></p>
</footer><!-- /.post-info -->                <p>I&#8217;ve been writing more and more pure functional code in both Scala and Java
recently. An issue I found myself running into quite often is this: say you
have a function that sometimes returns no results (e.g. looking up a key in a
map). A common way to deal with that in Scala is to return an <code>Option</code>:</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="n">foo</span><span class="o">(</span><span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
</pre></div>


<p>Simple enough. But then a typical use of such a function is to map it over all members of a&nbsp;collection:</p>
<div class="codehilite"><pre><span class="k">val</span> <span class="n">strings</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">foo</span> <span class="k">_</span><span class="o">)</span>
</pre></div>


<p>What ...</p>
                <a class="readmore" href="../scalas-missing-monad.html">read more</a>
                <p>There are <a href="../scalas-missing-monad.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../cocoa-vs-haskell.html" rel="bookmark"
                           title="Permalink to Cocoa vs Haskell">Cocoa vs&nbsp;Haskell</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-01-08T00:00:00">
                Fri 08 January 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/programming.html">programming</a><a href="../tag/cocoa.html">cocoa</a><a href="../tag/haskell.html">haskell</a></p>
</footer><!-- /.post-info -->                <p>So here&#8217;s the deal - if you want to write a Mac <span class="caps">GUI</span> app, you want to use the Cocoa framework. As a practical system for writing desktop <span class="caps">GUI</span> apps, the Cocoa stack simply has no equal anywhere. Part of what makes Cocoa so great is the Objective-C language, which adds a very flexible and dynamic <span class="caps">OOP</span> system on top of standard&nbsp;C.</p>
<p>Objective-C turned out to be a great match for creating desktop GUIs. It&#8217;s obviously a general-purpose language, but for general programming it would be no where near my first choice. My first choice right now would ...</p>
                <a class="readmore" href="../cocoa-vs-haskell.html">read more</a>
                <p>There are <a href="../cocoa-vs-haskell.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../some-simple-scala-null-tricks.html" rel="bookmark"
                           title="Permalink to Some Simple Scala Null Tricks">Some Simple Scala Null&nbsp;Tricks</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2009-12-16T00:00:00">
                Wed 16 December 2009
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/programming.html">programming</a><a href="../tag/scala.html">scala</a></p>
</footer><!-- /.post-info -->                <p>Scala code often needs to deal with null references, unfortunately. Such is
the price of Java interoperability. One of my favourite utility methods&nbsp;is:</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="o">?[</span><span class="kt">A</span> <span class="k">&lt;:</span> <span class="kt">AnyRef</span><span class="o">](</span><span class="n">ref</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">ref</span> <span class="n">eq</span> <span class="kc">null</span><span class="o">)</span> <span class="nc">None</span> <span class="k">else</span> <span class="nc">Some</span><span class="o">(</span><span class="n">ref</span><span class="o">)</span>

<span class="c1">// e.g.</span>
<span class="k">val</span> <span class="n">value</span> <span class="k">=</span> <span class="o">?(</span><span class="n">javaCallThatMayReturnNull</span><span class="o">()).</span><span class="n">getOrElse</span><span class="o">(</span><span class="n">defaultValue</span><span class="o">)</span>
</pre></div>


<p>Scala 2.8 offers this using <code>Option(ref)</code> instead of
<code>?(ref)</code>. However, I can&#8217;t figure out why the Scala 2.8 method
accepts non-reference values as&nbsp;well.</p>
<p>Another simple thing that may come in handy is an extractor for non-null&nbsp;values:</p>
<div class="codehilite"><pre><span class="k">object</span> <span class="nc">NotNull</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">unapply</span><span class="o">[</span><span class="kt">A</span> <span class="k">&lt;:</span> <span class="kt">AnyRef</span><span class="o">](</span><span class="n">ref</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">ref ...</span></pre></div>
                <a class="readmore" href="../some-simple-scala-null-tricks.html">read more</a>
                <p>There are <a href="../some-simple-scala-null-tricks.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../the-fsf-doesnt-care-if-theyre-lonely.html" rel="bookmark"
                           title="Permalink to The FSF Doesn’t Care if They’re Lonely">The <span class="caps">FSF</span> Doesn&#8217;t Care if They&#8217;re&nbsp;Lonely</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2009-07-06T00:00:00">
                Mon 06 July 2009
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/programming.html">programming</a><a href="../tag/rant.html">rant</a><a href="../tag/open-source.html">open source</a></p>
</footer><!-- /.post-info -->                <p>Daniel Jalkut, a leading light of the Mac developer community recently <a href="http://www.red-sweater.com/blog/825/getting-pretty-lonely">blogged about</a> the <a href="http://www.gnu.org/licenses/licenses.html#GPL"><span class="caps">GPL</span></a> and some of consequences of it for collaborative software development. I agree with what he says, and I dislike how the <span class="caps">GPL</span> limits collaboration in a number of ways. But I thought it might be useful to go over the background and objectives of the&nbsp;<span class="caps">GPL</span>.</p>
<p>There&#8217;s an important thing to remember when talking about the <span class="caps">GPL</span>: the impact, good or bad, on the practicalities of software development have nothing to do with its objectives. The authors of the <span class="caps">GPL</span>, the <a href="http://www.fsf.org/">Free Software Foundation ...</a></p>
                <a class="readmore" href="../the-fsf-doesnt-care-if-theyre-lonely.html">read more</a>
                <p>There are <a href="../the-fsf-doesnt-care-if-theyre-lonely.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../project-euler-problem-8.html" rel="bookmark"
                           title="Permalink to Project Euler Problem 8">Project Euler Problem&nbsp;8</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2009-06-01T23:00:00">
                Mon 01 June 2009
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/scala.html">scala</a><a href="../tag/programming.html">programming</a><a href="../tag/project-euler.html">project euler</a></p>
</footer><!-- /.post-info -->                <p>I guess I should warn that these Project Euler posts have <strong>spoilers</strong>, in case you want to try the problems yourself ☺. My Scala solution to <a href="http://projecteuler.net/problem=8">problem 8</a>:</p>
<div class="codehilite"><pre><span class="k">val</span> <span class="n">input</span> <span class="k">=</span> <span class="s">&quot;73167176531330624919225119674426574742355349194934&quot;</span> <span class="o">+</span>
  <span class="s">&quot;96983520312774506326239578318016984801869478851843&quot;</span> <span class="o">+</span>
  <span class="s">&quot;85861560789112949495459501737958331952853208805511&quot;</span> <span class="o">+</span>
  <span class="s">&quot;12540698747158523863050715693290963295227443043557&quot;</span> <span class="o">+</span>
  <span class="s">&quot;66896648950445244523161731856403098711121722383113&quot;</span> <span class="o">+</span>
  <span class="s">&quot;62229893423380308135336276614282806444486645238749&quot;</span> <span class="o">+</span>
  <span class="s">&quot;30358907296290491560440772390713810515859307960866&quot;</span> <span class="o">+</span>
  <span class="s">&quot;70172427121883998797908792274921901699720888093776&quot;</span> <span class="o">+</span>
  <span class="s">&quot;65727333001053367881220235421809751254540594752243&quot;</span> <span class="o">+</span>
  <span class="s">&quot;52584907711670556013604839586446706324415722155397&quot;</span> <span class="o">+</span>
  <span class="s">&quot;53697817977846174064955149290862569321978468622482&quot;</span> <span class="o">+</span>
  <span class="s">&quot;83972241375657056057490261407972968652414535100474&quot;</span> <span class="o">+</span>
  <span class="s">&quot;82166370484403199890008895243450658541227588666881&quot;</span> <span class="o">+</span>
  <span class="s">&quot;16427171479924442928230863465674813919123162824586&quot;</span> <span class="o">+</span>
  <span class="s">&quot;17866458359124566529476545682848912883142607690042&quot;</span> <span class="o">+</span>
  <span class="s">&quot;24219022671055626321111109370544217506941658960408&quot;</span> <span class="o">+</span>
  <span class="s">&quot;07198403850962455444362981230987879927244284909188&quot;</span> <span class="o">+</span>
  <span class="s">&quot;84580156166097919133875499200524063689912560717606&quot;</span> <span class="o">+</span>
  <span class="s">&quot;05886116467109405077541002256983155200055935729725&quot;</span> <span class="o">+</span>
  <span class="s">&quot;71636269561882670428252483600823257530420752963450&quot;</span>

<span class="k">val</span> <span class="n">digits</span> <span class="k">=</span> <span class="n">input</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">asDigit</span><span class="o">).</span><span class="n">toArray</span>

<span class="k">def</span> <span class="n">multiply</span><span class="o">(</span><span class="n">index</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">slice</span><span class="o">(</span><span class="n">index</span><span class="o">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">5</span><span class="o">)</span>
    <span class="o">.</span><span class="n">foldLeft</span><span class="o">(</span><span class="mi">1</span><span class="o">)(</span><span class="k">_</span><span class="o">*</span><span class="k">_</span><span class="o">)</span>

<span class="k">val</span> <span class="n">multiples</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">rec</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Stream</span><span class="o">.</span><span class="n">cons</span><span class="o">(</span><span class="n">multiply</span><span class="o">(</span><span class="n">n</span><span class="o">),</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">digits</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">5</span><span class="o">)</span> <span class="nc">Stream</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="n">rec</span><span class="o">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">))</span>
    <span class="nc">Stream</span><span class="o">.</span><span class="n">cons</span><span class="o">(</span><span class="n">mult</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="n">rec ...</span></pre></div>
                <a class="readmore" href="../project-euler-problem-8.html">read more</a>
                <p>There are <a href="../project-euler-problem-8.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../project-euler-in-scala.html" rel="bookmark"
                           title="Permalink to Project Euler in Scala">Project Euler in&nbsp;Scala</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2009-06-01T17:19:00">
                Mon 01 June 2009
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/scala.html">scala</a><a href="../tag/programming.html">programming</a><a href="../tag/project-euler.html">project euler</a></p>
</footer><!-- /.post-info -->                <p><a href="http://projecteuler.net/">Project Euler</a> is a bunch of mathematical/programming problems. I&#8217;ve been trying to improve my <a href="http://www.scala-lang.org/">Scala</a> skills by using it on some of the Euler problems. I&#8217;m trying to use functional programming styles as much as possible. My solutions definitely haven&#8217;t been very optimized, but I am learning, which is the&nbsp;aim.</p>
<p><strong><a href="http://projecteuler.net/problem=1">Euler Problem&nbsp;1</a></strong></p>
<blockquote>
<p>If we list all the natural numbers below 10 that are multiples of 3 or 5, we get 3, 5, 6 and 9. The sum of these multiples is 23.  Find the sum of all the multiples of 3 or 5 below ...</p></blockquote>
                <a class="readmore" href="../project-euler-in-scala.html">read more</a>
                <p>There are <a href="../project-euler-in-scala.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../logging-vs-string-construction.html" rel="bookmark"
                           title="Permalink to Logging vs String Construction">Logging vs String&nbsp;Construction</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2006-10-17T00:00:00">
                Tue 17 October 2006
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/java.html">java</a><a href="../tag/programming.html">programming</a></p>
</footer><!-- /.post-info -->                <p>A classic logging problem in Java is&nbsp;this:</p>
<div class="codehilite"><pre><span class="n">logger</span><span class="o">.</span><span class="na">finest</span><span class="o">(</span><span class="n">expensiveStringConstruction</span><span class="o">());</span>
</pre></div>


<p>The problem with this is that even when the logger&#8217;s level is above <span class="caps">FINEST</span> and the message is not logged, the message string must still be constructed. In cases where constructing the string involves a lot of work, your code can be slowed down significantly even when logging is off. The standard solution is like&nbsp;so:</p>
<div class="codehilite"><pre><span class="k">if</span> <span class="o">(</span><span class="n">logger</span><span class="o">.</span><span class="na">isLoggable</span><span class="o">(</span><span class="n">Level</span><span class="o">.</span><span class="na"><span class="caps">FINEST</span></span><span class="o">))</span> <span class="o">{</span>
  <span class="n">logger</span><span class="o">.</span><span class="na">finest</span><span class="o">(</span><span class="n">expensiveStringConstruction</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>


<p>By adding the <code>if</code> statement around the logging, the expensive string construction is only done if the message is actually going to be used ...</p>
                <a class="readmore" href="../logging-vs-string-construction.html">read more</a>
                <p>There are <a href="../logging-vs-string-construction.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../xml-vs-streams.html" rel="bookmark"
                           title="Permalink to XML vs Streams"><span class="caps">XML</span> vs&nbsp;Streams</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2006-09-26T00:00:00">
                Tue 26 September 2006
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/java.html">java</a><a href="../tag/programming.html">programming</a></p>
</footer><!-- /.post-info -->                <p>Ever get the feeling that <span class="caps">XML</span> sometimes makes things harder than they need to be? One of the problems that I and others have run into is that when parsing <span class="caps">XML</span> using <span class="caps">SAX</span> (or, in my case, using <span class="caps">JAXB</span> to unmarshall <span class="caps">XML</span>, which uses <span class="caps">SAX</span> under the hood) from an InputStream, the stream is always closed after the parsing is complete. This is surprising behaviour in Java, because you&#8217;re not supposed to close streams you don&#8217;t own. This can be a problem when <a href="http://weblogs.java.net/blog/kohsuke/archive/2005/07/socket_xml_pitf.html">using network sockets</a> or when you want to write two or more unrelated <span class="caps">XML</span> documents ...</p>
                <a class="readmore" href="../xml-vs-streams.html">read more</a>
                <p>There are <a href="../xml-vs-streams.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../javas-clone-mechanism-is-teh-suq.html" rel="bookmark"
                           title="Permalink to Java’s clone mechanism is teh suq">Java&#8217;s clone mechanism is teh&nbsp;suq</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2006-03-27T00:00:00">
                Mon 27 March 2006
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/java.html">java</a><a href="../tag/programming.html">programming</a></p>
</footer><!-- /.post-info -->                <p>Doing cloning properly in Java is way harder than it should be. I thought I knew all the traps, but recently found yet another. In a nutshell, making inner classes cloneable is almost always a bad idea. The reason is that inner classes have an internal reference to an instance of their enclosing class, which is implicitly final and can&#8217;t be changed as part of a clone. For&nbsp;example:</p>
<div class="codehilite"><pre><span class="kd">class</span> <span class="nc">Outer</span> <span class="kd">implements</span> <span class="n">Cloneable</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">Inner</span> <span class="n">inner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Inner</span><span class="o">();</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">clone</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="n">Outer</span> <span class="n">clone</span> <span class="o">=</span> <span class="o">(</span><span class="n">Outer</span><span class="o">)</span><span class="kd">super</span><span class="o">.</span><span class="na">clone</span><span class="o">();</span>
            <span class="n">clone</span><span class="o">.</span><span class="na">inner</span> <span class="o">=</span> <span class="o">(</span><span class="n">Inner</span><span class="o">)</span><span class="n">inner</span><span class="o">.</span><span class="na">clone</span><span class="o">();</span> <span class="c1">// A.</span>
            <span class="c1">// Cloned inner still ...</span></pre></div>
                <a class="readmore" href="../javas-clone-mechanism-is-teh-suq.html">read more</a>
                <p>There are <a href="../javas-clone-mechanism-is-teh-suq.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../handling-invocationtargetexception.html" rel="bookmark"
                           title="Permalink to Handling InvocationTargetException">Handling&nbsp;InvocationTargetException</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2005-12-23T00:00:00">
                Fri 23 December 2005
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/java.html">java</a><a href="../tag/programming.html">programming</a></p>
</footer><!-- /.post-info -->                <p>A quick hint on handling <code>java.lang.reflect.InvocationTargetException</code>.</p>
<p>This sucker is thrown whenever you invoke a method via reflection (typically via <code>Method.invoke</code>), and that method throws any sort of exception. So it doesn&#8217;t indicate a problem with the reflection mechanism, it is simply how the reflection mechanism notifies you of exceptions thrown by the method you&nbsp;called.</p>
<p>Whenever you catch this exception (and you will have to catch it at some level), the first thing you should do is call <code>getCause()</code>. This returns the exception thrown from the method that was invoked via reflection, and that&#8217;s ...</p>
                <a class="readmore" href="../handling-invocationtargetexception.html">read more</a>
                <p>There are <a href="../handling-invocationtargetexception.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../how-not-to-catch-exceptions.html" rel="bookmark"
                           title="Permalink to How Not to Catch Exceptions">How Not to Catch&nbsp;Exceptions</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2005-12-23T00:00:00">
                Fri 23 December 2005
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        <p>In <a href="../category/programming.html">programming</a>. </p>
<p>tags: <a href="../tag/java.html">java</a><a href="../tag/programming.html">programming</a></p>
</footer><!-- /.post-info -->                <p>When it comes to bad Java practices, top of my list would have to be catching exceptions like&nbsp;this:</p>
<div class="codehilite"><pre><span class="k">try</span> <span class="o">{</span>
   <span class="c1">// stuff - anything really</span>
<span class="o">}</span>
<span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// maybe log it if you&#39;re lucky</span>
<span class="o">}</span>
</pre></div>


<p>This is usually done because the &#8220;stuff&#8221; throws more than one kind of checked exception, and the code to handle each case is the same. So what&#8217;s wrong with it? The biggest problem is that this not only catches the checked exceptions you&#8217;re interested in, but also all <code>RuntimeException</code>s. The vast majority of <code>RuntimeException</code>s are only thrown from buggy code, and catching them ...</p>
                <a class="readmore" href="../how-not-to-catch-exceptions.html">read more</a>
                <p>There are <a href="../how-not-to-catch-exceptions.html#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            </ol><!-- /#posts-list -->
                                                    </section><!-- /#content -->
                    <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="http://www.scala-lang.org/">Scala</a></li>
                                                    <li><a href="http://www.playframework.com">Play Framework</a></li>
                                                    <li><a href="http://java.oracle.com/">Java</a></li>
                                                    <li><a href="http://www.apple.com/">Apple</a></li>
                                                    <li><a href="http://www.giantitp.com/comics/oots0001.html">The Order of the Stick</a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://quelgar.github.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="http://twitter.com/quelgar">Twitter</a></li>
                                                    <li><a href="https://github.com/quelgar">GitHub</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'wisdom-eludes-me';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>
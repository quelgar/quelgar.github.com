<!DOCTYPE html>
<html lang="en">
<head>
        <title>Wisdom Eludes Me - Lachlan O'Dea</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href=".././theme/css/main.css" type="text/css" />
        <link href="http://quelgar.github.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Wisdom Eludes Me Atom Feed" />
        

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie.css"/>
                <script src=".././js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

        <header id="banner" class="body">
                <h1><a href="../.">Wisdom Eludes Me </a></h1>
                <nav><ul>
                
                
                
                
                
                    <li ><a href=".././category/politics.html">politics</a></li>
                
                    <li ><a href=".././category/programming.html">programming</a></li>
                
                </ul></nav>
        </header><!-- /#banner -->
                

            

        
        
            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href=".././a-variation-on-scalas-either-type.html">A Variation on Scala&#8217;s Either&nbsp;Type</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2011-05-03T00:00:00">
                Tue 03 May 2011
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/scala.html">scala</a><a href=".././tag/programming.html">programming</a></p>


</footer><!-- /.post-info --><p>I&#8217;ve been using Scala&#8217;s <code>Either</code> type a bit recently, and found a
couple of minor annoyances with it. So as a learning exercise I tried to
make a variation of <code>Either</code>, and this is what I came up with. I also
wanted to experiment with syntax a little. See what you&nbsp;think.</p>
<p><code>Either</code> is a disjunctive type with two possible values: a <em>left</em> and a <em>right</em>.
It places no meaning at all on left or right, but 99% of its uses in practice
involve putting normal, expected values in right, and errors or other
&#8220;exceptional&#8221; values in left. This means that almost all the time you
end up getting the <code>RightProjection</code>,&nbsp;e.g.:</p>
<div class="codehilite"><pre><span class="k">for</span> <span class="o">{</span>
    <span class="n">v1</span> <span class="k">&lt;-</span> <span class="n">foo</span><span class="o">(</span><span class="err">…</span><span class="o">).</span><span class="n">right</span>
    <span class="n">v2</span> <span class="k">&lt;-</span> <span class="n">bar</span><span class="o">(</span><span class="err">…</span><span class="o">).</span><span class="n">right</span>
    <span class="n">v3</span> <span class="k">&lt;-</span> <span class="n">baz</span><span class="o">(</span><span class="err">…</span><span class="o">).</span><span class="n">right</span>
<span class="o">}</span>
<span class="k">yield</span> <span class="err">…</span>
</pre></div>


<p>Whereas I&#8217;ve never used <code>.left</code> even&nbsp;once.</p>
<p>The second minor issue is that Either has some limitations with patterns
in <code>for</code> expressions, because of how it is forced to implement the <code>filter</code>
method. See
<a href="http://stackoverflow.com/questions/5831453/why-does-this-scala-for-expression-using-tuples-fail-to-compile">this Stack Overflow question</a> for the&nbsp;details.</p>
<p>So I created a type that is explicitly designed to handle the possibility
of &#8220;exception&#8221; conditions. Because the word &#8220;exception&#8221; already has a well
known meaning on the <span class="caps">JVM</span>, I called this type <em>Anomaly</em> instead. Actually,
I ended up calling the type <code>|:</code> because I thought it worked nicely
syntactically. Here&#8217;s a comparison with <code>Either</code>:</p>
<div class="codehilite"><pre><span class="k">val</span> <span class="n">e1</span><span class="k">:</span> <span class="kt">Either</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Right</span><span class="o">(</span><span class="mi">30</span><span class="o">)</span>
<span class="k">val</span> <span class="n">e2</span><span class="k">:</span> <span class="kt">Either</span><span class="o">[</span><span class="kt">String</span>, <span class="o">(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">Right</span><span class="o">((</span><span class="mi">10</span><span class="o">,</span> <span class="mi">2</span><span class="o">))</span>
<span class="k">val</span> <span class="n">e3</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
    <span class="n">i</span> <span class="k">&lt;-</span> <span class="n">e1</span><span class="o">.</span><span class="n">right</span>
    <span class="n">j</span> <span class="k">&lt;-</span> <span class="n">e2</span><span class="o">.</span><span class="n">right</span>
<span class="o">}</span>
<span class="k">yield</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="o">.</span><span class="n">_1</span> <span class="o">+</span> <span class="n">j</span><span class="o">.</span><span class="n">_2</span>
<span class="k">val</span> <span class="n">e4</span><span class="k">:</span> <span class="kt">Either</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Left</span><span class="o">(</span><span class="s">&quot;error&quot;</span><span class="o">)</span>
</pre></div>


<p>vs&nbsp;&#8220;Anomaly&#8221;:</p>
<div class="codehilite"><pre><span class="k">val</span> <span class="n">a1</span><span class="k">:</span> <span class="kt">String</span> <span class="kt">|:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="nc">Expected</span><span class="o">(</span><span class="mi">30</span><span class="o">)</span>
<span class="k">val</span> <span class="n">a2</span><span class="k">:</span> <span class="kt">String</span> <span class="kt">|:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Expected</span><span class="o">((</span><span class="mi">10</span><span class="o">,</span> <span class="mi">2</span><span class="o">))</span>
<span class="k">val</span> <span class="n">a3</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
    <span class="n">i</span> <span class="k">&lt;-</span> <span class="n">a1</span>
    <span class="o">(</span><span class="n">j</span><span class="o">,</span> <span class="n">k</span><span class="o">)</span> <span class="k">&lt;-</span> <span class="n">a2</span>
<span class="o">}</span>
<span class="k">yield</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span>
<span class="k">val</span> <span class="n">a4</span><span class="k">:</span> <span class="kt">String</span> <span class="kt">|:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="nc">Anomaly</span><span class="o">(</span><span class="s">&quot;error&quot;</span><span class="o">)</span>
</pre></div>


<p>The <code>|:</code> operator is right-associative, which helps for the occasional cases where
you have an Anomaly within an Anomaly, eg. <code>String |: String |: Int</code> is
equivalent to <code>Either[String, Either[String, Int]]</code>. Of course, depending
on your taste you could reverse the order of type arguments,
using an operator like <code>:|</code>, or use a name instead of an&nbsp;operator.</p>
<p>There&#8217;s a cost to making the <code>for</code> expression pattern matching work like
this, however. In addition to the <code>Anomaly</code> and <code>Expected</code> cases, I had
to introduce a <code>NoValue</code> case object, which is what is returned when a
filter does not match. This is annoying, because now folding or pattern
matching must account for three cases instead of two. And unless you
have explicit filters or patterns matching particular values, the
<code>NoValue</code> outcome won&#8217;t come up, so it&#8217;s a pain to have to check for it.
What I ended up doing was providing an alternate two-parameter fold method
that calls <code>error</code> in case of a <code>NoValue</code>. You just have to be careful
about only calling it when you know it&#8217;s&nbsp;safe.</p>
<p>All-in-all I&#8217;m still wondering whether this experiment is worthwhile, but
here&#8217;s the code in case anyone is interested.
There are other utility methods that could be&nbsp;added:</p>
<div class="codehilite"><pre><span class="k">sealed</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">|:</span><span class="o">[</span><span class="kt">+A</span>, <span class="kt">+E</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">anomaly</span><span class="k">:</span> <span class="kt">A</span>
  <span class="k">def</span> <span class="n">expected</span><span class="k">:</span> <span class="kt">E</span>
  <span class="k">def</span> <span class="n">isExpected</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span>
  <span class="k">def</span> <span class="n">isAnomaly</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span>
  <span class="k">def</span> <span class="n">isNoValue</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span>

  <span class="k">def</span> <span class="n">map</span><span class="o">[</span><span class="kt">X</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="n">X</span><span class="o">)</span><span class="k">:</span> <span class="kt">A</span> <span class="kt">|:</span> <span class="kt">X</span>

  <span class="k">def</span> <span class="n">flatMap</span><span class="o">[</span><span class="kt">X</span>, <span class="kt"><span class="caps">AA</span></span> <span class="k">&gt;:</span> <span class="kt">A</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="nc"><span class="caps">AA</span></span> <span class="o">|:</span> <span class="n">X</span><span class="o">)</span><span class="k">:</span> <span class="kt"><span class="caps">AA</span></span> <span class="kt">|:</span> <span class="kt">X</span>

  <span class="k">def</span> <span class="n">withFilter</span><span class="o">(</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="nc">Boolean</span><span class="o">)</span><span class="k">:</span> <span class="kt">A</span> <span class="kt">|:</span> <span class="kt">E</span> <span class="o">=</span> <span class="k">this</span>
  <span class="k">final</span> <span class="k">def</span> <span class="n">filter</span><span class="o">(</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="nc">Boolean</span><span class="o">)</span><span class="k">:</span> <span class="kt">A</span> <span class="kt">|:</span> <span class="kt">E</span> <span class="o">=</span> <span class="n">withFilter</span><span class="o">(</span><span class="n">f</span><span class="o">)</span>

  <span class="k">def</span> <span class="n">foreach</span><span class="o">(</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{}</span>

  <span class="k">final</span> <span class="k">def</span> <span class="n">fold</span><span class="o">[</span><span class="kt">X</span><span class="o">](</span><span class="n">fExpected</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="n">X</span><span class="o">,</span> <span class="n">fAnomaly</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">X</span><span class="o">,</span> <span class="n">fNoValue</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">X</span><span class="o">)</span><span class="k">:</span> <span class="kt">X</span> <span class="o">=</span> <span class="k">this</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Anomaly</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">fAnomaly</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
    <span class="k">case</span> <span class="nc">Expected</span><span class="o">(</span><span class="n">e</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">fExpected</span><span class="o">(</span><span class="n">e</span><span class="o">)</span>
    <span class="k">case</span> <span class="nc">NoValue</span> <span class="k">=&gt;</span> <span class="n">fNoValue</span>
  <span class="o">}</span>

  <span class="k">final</span> <span class="k">def</span> <span class="n">fold</span><span class="o">[</span><span class="kt">X</span><span class="o">](</span><span class="n">fExpected</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="n">X</span><span class="o">,</span> <span class="n">fAnomaly</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">X</span><span class="o">)</span><span class="k">:</span> <span class="kt">X</span> <span class="o">=</span> <span class="k">this</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Anomaly</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">fAnomaly</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
    <span class="k">case</span> <span class="nc">Expected</span><span class="o">(</span><span class="n">e</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">fExpected</span><span class="o">(</span><span class="n">e</span><span class="o">)</span>
    <span class="k">case</span> <span class="nc">NoValue</span> <span class="k">=&gt;</span> <span class="n">error</span><span class="o">(</span><span class="s">&quot;Attempt to fold NoValue case&quot;</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">final</span> <span class="k">def</span> <span class="n">join</span><span class="o">[</span><span class="kt">X</span>, <span class="kt"><span class="caps">AA</span></span> <span class="k">&gt;:</span> <span class="kt">A</span><span class="o">](</span><span class="k">implicit</span> <span class="n">ev</span><span class="k">:</span> <span class="kt">E</span> <span class="k">&lt;:</span><span class="kt">&lt;</span> <span class="o">(</span><span class="kt"><span class="caps">AA</span></span> <span class="kt">|:</span> <span class="kt">X</span><span class="o">))</span><span class="k">:</span> <span class="kt"><span class="caps">AA</span></span> <span class="kt">|:</span> <span class="kt">X</span> <span class="o">=</span> <span class="k">this</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Anomaly</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Anomaly</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
    <span class="k">case</span> <span class="nc">Expected</span><span class="o">(</span><span class="n">e</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">e</span>
    <span class="k">case</span> <span class="nc">NoValue</span> <span class="k">=&gt;</span> <span class="nc">NoValue</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Expected</span><span class="o">[</span><span class="kt">+A</span>, <span class="kt">+E</span><span class="o">](</span><span class="n">expected</span><span class="k">:</span> <span class="kt">E</span><span class="o">)</span> <span class="k">extends</span> <span class="o">(</span><span class="n">A</span> <span class="o">|:</span> <span class="n">E</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">isExpected</span> <span class="k">=</span> <span class="kc">true</span>
  <span class="k">def</span> <span class="n">anomaly</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=</span> <span class="nc">Predef</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="s">&quot;Not an anomaly&quot;</span><span class="o">)</span>

  <span class="k">override</span> <span class="k">def</span> <span class="n">withFilter</span><span class="o">(</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="nc">Boolean</span><span class="o">)</span> <span class="k">=</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">f</span><span class="o">(</span><span class="n">expected</span><span class="o">))</span> <span class="k">this</span> <span class="k">else</span> <span class="nc">NoValue</span>

  <span class="k">def</span> <span class="n">flatMap</span><span class="o">[</span><span class="kt">X</span>, <span class="kt"><span class="caps">AA</span></span> <span class="k">&gt;:</span> <span class="kt">A</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="nc"><span class="caps">AA</span></span> <span class="o">|:</span> <span class="n">X</span><span class="o">)</span> <span class="k">=</span> <span class="n">f</span><span class="o">(</span><span class="n">expected</span><span class="o">)</span>

  <span class="k">def</span> <span class="n">map</span><span class="o">[</span><span class="kt">X</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="n">X</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Expected</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">X</span><span class="o">](</span><span class="n">f</span><span class="o">(</span><span class="n">expected</span><span class="o">))</span>

  <span class="k">override</span> <span class="k">def</span> <span class="n">foreach</span><span class="o">(</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">f</span><span class="o">(</span><span class="n">expected</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Expected</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">cond</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">E</span><span class="o">](</span><span class="n">test</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">,</span> <span class="n">expected</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">E</span><span class="o">,</span> <span class="n">anomaly</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">A</span><span class="o">)</span><span class="k">:</span> <span class="kt">A</span> <span class="kt">|:</span> <span class="kt">E</span> <span class="o">=</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">test</span><span class="o">)</span> <span class="nc">Expected</span><span class="o">(</span><span class="n">expected</span><span class="o">)</span> <span class="k">else</span> <span class="nc">Anomaly</span><span class="o">(</span><span class="n">anomaly</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Anomaly</span><span class="o">[</span><span class="kt">+A</span>, <span class="kt">+E</span><span class="o">](</span><span class="n">anomaly</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span> <span class="k">extends</span> <span class="o">(</span><span class="n">A</span> <span class="o">|:</span> <span class="n">E</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">isAnomaly</span> <span class="k">=</span> <span class="kc">true</span>
  <span class="k">def</span> <span class="n">expected</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=</span> <span class="nc">Predef</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="s">&quot;Not an expected value&quot;</span><span class="o">)</span>

  <span class="k">def</span> <span class="n">flatMap</span><span class="o">[</span><span class="kt">X</span>, <span class="kt"><span class="caps">AA</span></span> <span class="k">&gt;:</span> <span class="kt">A</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="nc"><span class="caps">AA</span></span> <span class="o">|:</span> <span class="n">X</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Anomaly</span><span class="o">[</span><span class="kt"><span class="caps">AA</span></span>, <span class="kt">X</span><span class="o">](</span><span class="n">anomaly</span><span class="o">)</span>

  <span class="k">def</span> <span class="n">map</span><span class="o">[</span><span class="kt">X</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">E</span> <span class="o">=&gt;</span> <span class="n">X</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Anomaly</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">X</span><span class="o">](</span><span class="n">anomaly</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Anomaly</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">cond</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">E</span><span class="o">](</span><span class="n">test</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">,</span> <span class="n">anomaly</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">A</span><span class="o">,</span> <span class="n">expected</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">E</span><span class="o">)</span><span class="k">:</span> <span class="kt">A</span> <span class="kt">|:</span> <span class="kt">E</span> <span class="o">=</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">test</span><span class="o">)</span> <span class="nc">Anomaly</span><span class="o">(</span><span class="n">anomaly</span><span class="o">)</span> <span class="k">else</span> <span class="nc">Expected</span><span class="o">(</span><span class="n">expected</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">case</span> <span class="k">object</span> <span class="nc">NoValue</span> <span class="k">extends</span> <span class="o">(</span><span class="nc">Nothing</span> <span class="o">|:</span> <span class="nc">Nothing</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">isNoValue</span> <span class="k">=</span> <span class="kc">true</span>
  <span class="k">def</span> <span class="n">anomaly</span> <span class="k">=</span> <span class="nc">Predef</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="s">&quot;Not an anomaly&quot;</span><span class="o">)</span>
  <span class="k">def</span> <span class="n">expected</span> <span class="k">=</span> <span class="nc">Predef</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="s">&quot;No value&quot;</span><span class="o">)</span>

  <span class="k">def</span> <span class="n">flatMap</span><span class="o">[</span><span class="kt">X</span>, <span class="kt"><span class="caps">AA</span></span> <span class="k">&gt;:</span> <span class="kt">Nothing</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">Nothing</span> <span class="o">=&gt;</span> <span class="nc"><span class="caps">AA</span></span> <span class="o">|:</span> <span class="n">X</span><span class="o">)</span> <span class="k">=</span> <span class="k">this</span>

  <span class="k">def</span> <span class="n">map</span><span class="o">[</span><span class="kt">X</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">Nothing</span> <span class="o">=&gt;</span> <span class="n">X</span><span class="o">)</span> <span class="k">=</span> <span class="k">this</span>
<span class="o">}</span>
</pre></div><p>There are <a href=".././a-variation-on-scalas-either-type.html#disqus_thread">comments</a>.</p>
                </article>
                
            </aside><!-- /#featured -->
            
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
            
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././applying-applicative-functors-in-scala.html" rel="bookmark"
                           title="Permalink to Applying Applicative Functors in Scala">Applying Applicative Functors in&nbsp;Scala</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2011-09-02T00:00:00">
                Fri 02 September 2011
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/scala.html">scala</a><a href=".././tag/programming.html">programming</a></p>


</footer><!-- /.post-info -->
                <p>A chap named ittayd has written a nice <a href="http://www.tikalk.com/incubator/blog/functional-programming-scala-rest-us">gentle tutorial on functional programming in Scala</a>. My only minor complaint is that he calls the applicative functor &#8220;sequential application&#8221; function <code>apply</code>. While this is a logical choice, in Scala <code>apply</code> is used everywhere to implement plain old function application, so it could lead to confusion. I think it&#8217;s better to call it <code>&lt;*&gt;</code>, as in Haskell. Read&nbsp;on.</p>
<p>I found the tutorial interesting because it talks a bit about applicative functors, and how to give them a nice syntax in Scala. The one thing that has bugged me about applicatives is ...</p>
                <a class="readmore" href=".././applying-applicative-functors-in-scala.html">read more</a>
                <p>There are <a href=".././applying-applicative-functors-in-scala.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././ceylon-interesting-for-the-wrong-reasons.html" rel="bookmark"
                           title="Permalink to Ceylon: Interesting For The Wrong Reasons">Ceylon: Interesting For The Wrong&nbsp;Reasons</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2011-04-15T00:00:00">
                Fri 15 April 2011
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/ceylon.html">ceylon</a><a href=".././tag/flameage.html">flameage</a><a href=".././tag/java.html">java</a><a href=".././tag/scala.html">scala</a></p>


</footer><!-- /.post-info -->
                <p>A couple of days ago, Gavin King announced that he is leading a team at RedHat that&#8217;s creating a new <span class="caps">JVM</span> language called Ceylon. See <a href="http://in.relation.to/19161.lace">here</a> for most of what is known so far. The stated motivation, in a nutshell is that they like Java very much, but it has deficiencies that are preventing progress in key areas, and they are generally feeling &#8220;frustrated&#8221;. They don&#8217;t have a complete compiler yet, but they&#8217;re working on it, and I get the impression RedHat is pretty serious about&nbsp;it.</p>
<p>Gavin King&#8217;s slides provide a fascinating insight into the ...</p>
                <a class="readmore" href=".././ceylon-interesting-for-the-wrong-reasons.html">read more</a>
                <p>There are <a href=".././ceylon-interesting-for-the-wrong-reasons.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././cocoa-vs-haskell.html" rel="bookmark"
                           title="Permalink to Cocoa vs Haskell">Cocoa vs&nbsp;Haskell</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-01-08T00:00:00">
                Fri 08 January 2010
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/programming.html">programming</a><a href=".././tag/cocoa.html">cocoa</a><a href=".././tag/haskell.html">haskell</a></p>


</footer><!-- /.post-info -->
                <p>So here&#8217;s the deal - if you want to write a Mac <span class="caps">GUI</span> app, you want to use the Cocoa framework. As a practical system for writing desktop <span class="caps">GUI</span> apps, the Cocoa stack simply has no equal anywhere. Part of what makes Cocoa so great is the Objective-C language, which adds a very flexible and dynamic <span class="caps">OOP</span> system on top of standard&nbsp;C.</p>
<p>Objective-C turned out to be a great match for creating desktop GUIs. It&#8217;s obviously a general-purpose language, but for general programming it would be no where near my first choice. My first choice right now would ...</p>
                <a class="readmore" href=".././cocoa-vs-haskell.html">read more</a>
                <p>There are <a href=".././cocoa-vs-haskell.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././creationism-and-climate-change-denial.html" rel="bookmark"
                           title="Permalink to Creationism and Climate Change Denial">Creationism and Climate Change&nbsp;Denial</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-12-21T00:00:00">
                Tue 21 December 2010
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/politics.html">politics</a>. </p>
<p>tags: <a href=".././tag/evolution.html">evolution</a><a href=".././tag/politics.html">politics</a><a href=".././tag/religion.html">religion</a><a href=".././tag/climate-change.html">climate change</a></p>


</footer><!-- /.post-info -->
                <p>I’ve noticed this more and more: people lumping “climate change denial” and “evolution denial” (creationism) into the same category. The argument is that both of these are the result of the same religious conservative “anti-science” movement. In a very narrow sense, this is true; creationists generally do not seem to believe in anthropogenic global warming (<span class="caps">AGW</span>), for the same bogus reasons they don’t believe in evolution. But the reverse is not true: many (most I would say) <span class="caps">AGW</span> skeptics are not creationists. Lumping these two things together allows the environmentalists to dismiss any criticism of the established climate ...</p>
                <a class="readmore" href=".././creationism-and-climate-change-denial.html">read more</a>
                <p>There are <a href=".././creationism-and-climate-change-denial.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././do-you-get-referential-transparency.html" rel="bookmark"
                           title="Permalink to Do You Get Referential Transparency?">Do You Get Referential&nbsp;Transparency?</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-07-15T00:00:00">
                Sun 15 July 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/scala.html">scala</a><a href=".././tag/programming.html">programming</a></p>


</footer><!-- /.post-info -->
                <p>Do you get referential transparency? I mean, really <em>get</em> it? I thought I did, but I recently gained a deeper appreciation for what it&nbsp;means.</p>
<p>Referential transparency is also commonly referred to as &#8220;pure&#8221; functional programming. I understood this to mean that the code lacked side effects like performing I/O or mutating state, and this seems to be a common understanding. But referential transparency can actually be defined quite precisely and succinctly (although I believe agreement with this definition would be far from&nbsp;universal):</p>
<blockquote>
<p>If replacing expression x by its value produces the same behaviour, then x is referentially ...</p></blockquote>
                <a class="readmore" href=".././do-you-get-referential-transparency.html">read more</a>
                <p>There are <a href=".././do-you-get-referential-transparency.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././handling-invocationtargetexception.html" rel="bookmark"
                           title="Permalink to Handling InvocationTargetException">Handling&nbsp;InvocationTargetException</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2005-12-23T00:00:00">
                Fri 23 December 2005
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/java.html">java</a><a href=".././tag/programming.html">programming</a></p>


</footer><!-- /.post-info -->
                <p>A quick hint on handling <code>java.lang.reflect.InvocationTargetException</code>.</p>
<p>This sucker is thrown whenever you invoke a method via reflection (typically via <code>Method.invoke</code>), and that method throws any sort of exception. So it doesn&#8217;t indicate a problem with the reflection mechanism, it is simply how the reflection mechanism notifies you of exceptions thrown by the method you&nbsp;called.</p>
<p>Whenever you catch this exception (and you will have to catch it at some level), the first thing you should do is call <code>getCause()</code>. This returns the exception thrown from the method that was invoked via reflection, and that&#8217;s ...</p>
                <a class="readmore" href=".././handling-invocationtargetexception.html">read more</a>
                <p>There are <a href=".././handling-invocationtargetexception.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././how-not-to-catch-exceptions.html" rel="bookmark"
                           title="Permalink to How Not to Catch Exceptions">How Not to Catch&nbsp;Exceptions</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2005-12-23T00:00:00">
                Fri 23 December 2005
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/java.html">java</a><a href=".././tag/programming.html">programming</a></p>


</footer><!-- /.post-info -->
                <p>When it comes to bad Java practices, top of my list would have to be catching exceptions like&nbsp;this:</p>
<div class="codehilite"><pre><span class="k">try</span> <span class="o">{</span>
   <span class="c1">// stuff - anything really</span>
<span class="o">}</span>
<span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// maybe log it if you&#39;re lucky</span>
<span class="o">}</span>
</pre></div>


<p>This is usually done because the &#8220;stuff&#8221; throws more than one kind of checked exception, and the code to handle each case is the same. So what&#8217;s wrong with it? The biggest problem is that this not only catches the checked exceptions you&#8217;re interested in, but also all <code>RuntimeException</code>s. The vast majority of <code>RuntimeException</code>s are only thrown from buggy code, and catching them ...</p>
                <a class="readmore" href=".././how-not-to-catch-exceptions.html">read more</a>
                <p>There are <a href=".././how-not-to-catch-exceptions.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././java-and-the-mac.html" rel="bookmark"
                           title="Permalink to Java and the Mac">Java and the&nbsp;Mac</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-10-23T00:00:00">
                Sat 23 October 2010
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/java.html">java</a><a href=".././tag/apple.html">apple</a><a href=".././tag/speculation.html">speculation</a></p>


</footer><!-- /.post-info -->
                <p>So Apple has quietly announced that it is <a href="http://developer.apple.com/library/mac/#releasenotes/Java/JavaSnowLeopardUpdate3LeopardUpdate8RN/NewandNoteworthy/NewandNoteworthy.html%23//apple_ref/doc/uid/TP40010380-CH4-SW1">deprecating its support for Java on the Mac</a>. The wording was (not uncharacteristically for situations like this) a bit vague on the details of what this means. I think two things are definite: 1) Apple will continue to support Java 6 on Snow Leopard until it reaches end of life; which I think happens when the <span class="caps">OS</span> <em>after</em> Lion is publicly released. 2) Apple will not port Java 7+ to the Mac. The main unresolved question is whether Java 6 will be supported on Lion. My guess is that it will be ...</p>
                <a class="readmore" href=".././java-and-the-mac.html">read more</a>
                <p>There are <a href=".././java-and-the-mac.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././javas-clone-mechanism-is-teh-suq.html" rel="bookmark"
                           title="Permalink to Java’s clone mechanism is teh suq">Java&#8217;s clone mechanism is teh&nbsp;suq</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2006-03-27T00:00:00">
                Mon 27 March 2006
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/java.html">java</a><a href=".././tag/programming.html">programming</a></p>


</footer><!-- /.post-info -->
                <p>Doing cloning properly in Java is way harder than it should be. I thought I knew all the traps, but recently found yet another. In a nutshell, making inner classes cloneable is almost always a bad idea. The reason is that inner classes have an internal reference to an instance of their enclosing class, which is implicitly final and can&#8217;t be changed as part of a clone. For&nbsp;example:</p>
<div class="codehilite"><pre><span class="kd">class</span> <span class="nc">Outer</span> <span class="kd">implements</span> <span class="n">Cloneable</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">Inner</span> <span class="n">inner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Inner</span><span class="o">();</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">clone</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="n">Outer</span> <span class="n">clone</span> <span class="o">=</span> <span class="o">(</span><span class="n">Outer</span><span class="o">)</span><span class="kd">super</span><span class="o">.</span><span class="na">clone</span><span class="o">();</span>
            <span class="n">clone</span><span class="o">.</span><span class="na">inner</span> <span class="o">=</span> <span class="o">(</span><span class="n">Inner</span><span class="o">)</span><span class="n">inner</span><span class="o">.</span><span class="na">clone</span><span class="o">();</span> <span class="c1">// A.</span>
            <span class="c1">// Cloned inner still ...</span></pre></div>
                <a class="readmore" href=".././javas-clone-mechanism-is-teh-suq.html">read more</a>
                <p>There are <a href=".././javas-clone-mechanism-is-teh-suq.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././logging-vs-string-construction.html" rel="bookmark"
                           title="Permalink to Logging vs String Construction">Logging vs String&nbsp;Construction</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2006-10-17T00:00:00">
                Tue 17 October 2006
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/java.html">java</a><a href=".././tag/programming.html">programming</a></p>


</footer><!-- /.post-info -->
                <p>A classic logging problem in Java is&nbsp;this:</p>
<div class="codehilite"><pre><span class="n">logger</span><span class="o">.</span><span class="na">finest</span><span class="o">(</span><span class="n">expensiveStringConstruction</span><span class="o">());</span>
</pre></div>


<p>The problem with this is that even when the logger&#8217;s level is above <span class="caps">FINEST</span> and the message is not logged, the message string must still be constructed. In cases where constructing the string involves a lot of work, your code can be slowed down significantly even when logging is off. The standard solution is like&nbsp;so:</p>
<div class="codehilite"><pre><span class="k">if</span> <span class="o">(</span><span class="n">logger</span><span class="o">.</span><span class="na">isLoggable</span><span class="o">(</span><span class="n">Level</span><span class="o">.</span><span class="na"><span class="caps">FINEST</span></span><span class="o">))</span> <span class="o">{</span>
  <span class="n">logger</span><span class="o">.</span><span class="na">finest</span><span class="o">(</span><span class="n">expensiveStringConstruction</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>


<p>By adding the <code>if</code> statement around the logging, the expensive string construction is only done if the message is actually going to be used ...</p>
                <a class="readmore" href=".././logging-vs-string-construction.html">read more</a>
                <p>There are <a href=".././logging-vs-string-construction.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././lying-to-stop-same-sex-marriage.html" rel="bookmark"
                           title="Permalink to Lying to Stop Same Sex Marriage">Lying to Stop Same Sex&nbsp;Marriage</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-05-13T00:00:00">
                Sun 13 May 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/politics.html">politics</a>. </p>
<p>tags: <a href=".././tag/politics.html">politics</a><a href=".././tag/gay-marriage.html">gay marriage</a><a href=".././tag/religion.html">religion</a></p>


</footer><!-- /.post-info -->
                <p>So it so happened that Ten News was on the <span class="caps">T.V.</span> at our place tonight (this is in Melbourne, Australia). Nothing remarkable until <a href="http://ten.com.au/video-player.htm?movideo_m=188000&amp;movideo_p=44243">a story</a> about 150 doctors issuing a warning that same-sex marriage poses &#8220;health risks&#8221;. The group behind this is called <a href="http://www.doctors4family.com.au/">Doctors For The Family</a>, which calls itself a &#8220;medical organisation to highlight the health aspects of marriage&#8221;. Ten just described them as &#8220;a conservative medical group&#8221;, a term that to me seems nonsensical. But I immediately thought &#8220;I bet it&#8217;s a Christian fundamentalist&nbsp;front&#8221;.</p>
<p>The Doctors For The Family web site is remarkably coy about ...</p>
                <a class="readmore" href=".././lying-to-stop-same-sex-marriage.html">read more</a>
                <p>There are <a href=".././lying-to-stop-same-sex-marriage.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././more-thoughts-on-apple-and-java.html" rel="bookmark"
                           title="Permalink to More Thoughts on Apple and Java">More Thoughts on Apple and&nbsp;Java</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-10-27T00:00:00">
                Wed 27 October 2010
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/java.html">java</a><a href=".././tag/apple.html">apple</a><a href=".././tag/speculation.html">speculation</a></p>


</footer><!-- /.post-info -->
                <p>A few more points that occurred to me, following up on my last&nbsp;post.</p>
<h1>Whither the&nbsp;Mouse?</h1>
<p>Since its inception in 1984, the Mac user interface has obviously been
designed for desktop computers with a mouse and a keyboard. When notebook
computers came along and we wanted to be able to use them without carrying a
mouse everywhere, or without even a flat, stable surface to put the mouse on,
they had to emulate the mouse as best they could. This may now be&nbsp;reversing.</p>
<p>In the announcement of Mac <span class="caps">OS</span> X Lion, there was great
emphasis placed on the ...</p>
                <a class="readmore" href=".././more-thoughts-on-apple-and-java.html">read more</a>
                <p>There are <a href=".././more-thoughts-on-apple-and-java.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././project-euler-in-scala.html" rel="bookmark"
                           title="Permalink to Project Euler in Scala">Project Euler in&nbsp;Scala</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2009-06-01T17:19:00">
                Mon 01 June 2009
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/scala.html">scala</a><a href=".././tag/programming.html">programming</a><a href=".././tag/project-euler.html">project euler</a></p>


</footer><!-- /.post-info -->
                <p><a href="http://projecteuler.net/">Project Euler</a> is a bunch of mathematical/programming problems. I&#8217;ve been trying to improve my <a href="http://www.scala-lang.org/">Scala</a> skills by using it on some of the Euler problems. I&#8217;m trying to use functional programming styles as much as possible. My solutions definitely haven&#8217;t been very optimized, but I am learning, which is the&nbsp;aim.</p>
<p><strong><a href="http://projecteuler.net/problem=1">Euler Problem&nbsp;1</a></strong></p>
<blockquote>
<p>If we list all the natural numbers below 10 that are multiples of 3 or 5, we get 3, 5, 6 and 9. The sum of these multiples is 23.  Find the sum of all the multiples of 3 or 5 below ...</p></blockquote>
                <a class="readmore" href=".././project-euler-in-scala.html">read more</a>
                <p>There are <a href=".././project-euler-in-scala.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././project-euler-problem-8.html" rel="bookmark"
                           title="Permalink to Project Euler Problem 8">Project Euler Problem&nbsp;8</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2009-06-01T23:00:00">
                Mon 01 June 2009
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/scala.html">scala</a><a href=".././tag/programming.html">programming</a><a href=".././tag/project-euler.html">project euler</a></p>


</footer><!-- /.post-info -->
                <p>I guess I should warn that these Project Euler posts have <strong>spoilers</strong>, in case you want to try the problems yourself ☺. My Scala solution to <a href="http://projecteuler.net/problem=8">problem 8</a>:</p>
<div class="codehilite"><pre><span class="k">val</span> <span class="n">input</span> <span class="k">=</span> <span class="s">&quot;73167176531330624919225119674426574742355349194934&quot;</span> <span class="o">+</span>
  <span class="s">&quot;96983520312774506326239578318016984801869478851843&quot;</span> <span class="o">+</span>
  <span class="s">&quot;85861560789112949495459501737958331952853208805511&quot;</span> <span class="o">+</span>
  <span class="s">&quot;12540698747158523863050715693290963295227443043557&quot;</span> <span class="o">+</span>
  <span class="s">&quot;66896648950445244523161731856403098711121722383113&quot;</span> <span class="o">+</span>
  <span class="s">&quot;62229893423380308135336276614282806444486645238749&quot;</span> <span class="o">+</span>
  <span class="s">&quot;30358907296290491560440772390713810515859307960866&quot;</span> <span class="o">+</span>
  <span class="s">&quot;70172427121883998797908792274921901699720888093776&quot;</span> <span class="o">+</span>
  <span class="s">&quot;65727333001053367881220235421809751254540594752243&quot;</span> <span class="o">+</span>
  <span class="s">&quot;52584907711670556013604839586446706324415722155397&quot;</span> <span class="o">+</span>
  <span class="s">&quot;53697817977846174064955149290862569321978468622482&quot;</span> <span class="o">+</span>
  <span class="s">&quot;83972241375657056057490261407972968652414535100474&quot;</span> <span class="o">+</span>
  <span class="s">&quot;82166370484403199890008895243450658541227588666881&quot;</span> <span class="o">+</span>
  <span class="s">&quot;16427171479924442928230863465674813919123162824586&quot;</span> <span class="o">+</span>
  <span class="s">&quot;17866458359124566529476545682848912883142607690042&quot;</span> <span class="o">+</span>
  <span class="s">&quot;24219022671055626321111109370544217506941658960408&quot;</span> <span class="o">+</span>
  <span class="s">&quot;07198403850962455444362981230987879927244284909188&quot;</span> <span class="o">+</span>
  <span class="s">&quot;84580156166097919133875499200524063689912560717606&quot;</span> <span class="o">+</span>
  <span class="s">&quot;05886116467109405077541002256983155200055935729725&quot;</span> <span class="o">+</span>
  <span class="s">&quot;71636269561882670428252483600823257530420752963450&quot;</span>

<span class="k">val</span> <span class="n">digits</span> <span class="k">=</span> <span class="n">input</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">asDigit</span><span class="o">).</span><span class="n">toArray</span>

<span class="k">def</span> <span class="n">multiply</span><span class="o">(</span><span class="n">index</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">slice</span><span class="o">(</span><span class="n">index</span><span class="o">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">5</span><span class="o">)</span>
    <span class="o">.</span><span class="n">foldLeft</span><span class="o">(</span><span class="mi">1</span><span class="o">)(</span><span class="k">_</span><span class="o">*</span><span class="k">_</span><span class="o">)</span>

<span class="k">val</span> <span class="n">multiples</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">rec</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Stream</span><span class="o">.</span><span class="n">cons</span><span class="o">(</span><span class="n">multiply</span><span class="o">(</span><span class="n">n</span><span class="o">),</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">digits</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">5</span><span class="o">)</span> <span class="nc">Stream</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="n">rec</span><span class="o">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">))</span>
    <span class="nc">Stream</span><span class="o">.</span><span class="n">cons</span><span class="o">(</span><span class="n">mult</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="n">rec ...</span></pre></div>
                <a class="readmore" href=".././project-euler-problem-8.html">read more</a>
                <p>There are <a href=".././project-euler-problem-8.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././scalas-missing-monad.html" rel="bookmark"
                           title="Permalink to Scala’s Missing Monad">Scala&#8217;s Missing&nbsp;Monad</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-09-30T00:00:00">
                Thu 30 September 2010
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/programming.html">programming</a><a href=".././tag/scala.html">scala</a><a href=".././tag/haskell.html">haskell</a></p>


</footer><!-- /.post-info -->
                <p>I&#8217;ve been writing more and more pure functional code in both Scala and Java
recently. An issue I found myself running into quite often is this: say you
have a function that sometimes returns no results (e.g. looking up a key in a
map). A common way to deal with that in Scala is to return an <code>Option</code>:</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="n">foo</span><span class="o">(</span><span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
</pre></div>


<p>Simple enough. But then a typical use of such a function is to map it over all members of a&nbsp;collection:</p>
<div class="codehilite"><pre><span class="k">val</span> <span class="n">strings</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">foo</span> <span class="k">_</span><span class="o">)</span>
</pre></div>


<p>What ...</p>
                <a class="readmore" href=".././scalas-missing-monad.html">read more</a>
                <p>There are <a href=".././scalas-missing-monad.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././some-simple-scala-null-tricks.html" rel="bookmark"
                           title="Permalink to Some Simple Scala Null Tricks">Some Simple Scala Null&nbsp;Tricks</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2009-12-16T00:00:00">
                Wed 16 December 2009
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/programming.html">programming</a><a href=".././tag/scala.html">scala</a></p>


</footer><!-- /.post-info -->
                <p>Scala code often needs to deal with null references, unfortunately. Such is
the price of Java interoperability. One of my favourite utility methods&nbsp;is:</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="o">?[</span><span class="kt">A</span> <span class="k">&lt;:</span> <span class="kt">AnyRef</span><span class="o">](</span><span class="n">ref</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">ref</span> <span class="n">eq</span> <span class="kc">null</span><span class="o">)</span> <span class="nc">None</span> <span class="k">else</span> <span class="nc">Some</span><span class="o">(</span><span class="n">ref</span><span class="o">)</span>

<span class="c1">// e.g.</span>
<span class="k">val</span> <span class="n">value</span> <span class="k">=</span> <span class="o">?(</span><span class="n">javaCallThatMayReturnNull</span><span class="o">()).</span><span class="n">getOrElse</span><span class="o">(</span><span class="n">defaultValue</span><span class="o">)</span>
</pre></div>


<p>Scala 2.8 offers this using <code>Option(ref)</code> instead of
<code>?(ref)</code>. However, I can&#8217;t figure out why the Scala 2.8 method
accepts non-reference values as&nbsp;well.</p>
<p>Another simple thing that may come in handy is an extractor for non-null&nbsp;values:</p>
<div class="codehilite"><pre><span class="k">object</span> <span class="nc">NotNull</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">unapply</span><span class="o">[</span><span class="kt">A</span> <span class="k">&lt;:</span> <span class="kt">AnyRef</span><span class="o">](</span><span class="n">ref</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">ref ...</span></pre></div>
                <a class="readmore" href=".././some-simple-scala-null-tricks.html">read more</a>
                <p>There are <a href=".././some-simple-scala-null-tricks.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././the-fsf-doesnt-care-if-theyre-lonely.html" rel="bookmark"
                           title="Permalink to The FSF Doesn’t Care if They’re Lonely">The <span class="caps">FSF</span> Doesn&#8217;t Care if They&#8217;re&nbsp;Lonely</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2009-07-06T00:00:00">
                Mon 06 July 2009
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/programming.html">programming</a><a href=".././tag/rant.html">rant</a><a href=".././tag/open-source.html">open source</a></p>


</footer><!-- /.post-info -->
                <p>Daniel Jalkut, a leading light of the Mac developer community recently <a href="http://www.red-sweater.com/blog/825/getting-pretty-lonely">blogged about</a> the <a href="http://www.gnu.org/licenses/licenses.html#GPL"><span class="caps">GPL</span></a> and some of consequences of it for collaborative software development. I agree with what he says, and I dislike how the <span class="caps">GPL</span> limits collaboration in a number of ways. But I thought it might be useful to go over the background and objectives of the&nbsp;<span class="caps">GPL</span>.</p>
<p>There&#8217;s an important thing to remember when talking about the <span class="caps">GPL</span>: the impact, good or bad, on the practicalities of software development have nothing to do with its objectives. The authors of the <span class="caps">GPL</span>, the <a href="http://www.fsf.org/">Free Software Foundation ...</a></p>
                <a class="readmore" href=".././the-fsf-doesnt-care-if-theyre-lonely.html">read more</a>
                <p>There are <a href=".././the-fsf-doesnt-care-if-theyre-lonely.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././thoughts-on-kony-2012.html" rel="bookmark"
                           title="Permalink to Thoughts on Kony 2012">Thoughts on Kony&nbsp;2012</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-03-10T00:00:00">
                Sat 10 March 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/politics.html">politics</a>. </p>
<p>tags: <a href=".././tag/politics.html">politics</a><a href=".././tag/foreign-policy.html">foreign policy</a></p>


</footer><!-- /.post-info -->
                <p>Watching the <a href="http://www.kony2012.com">Kony 2012</a> phenomenon unfold has been interesting. I&#8217;ve come to the conclusion that while the people behind they campaign are well-meaning, its not really useful or helpful. In other words, it&#8217;s pretty typical of campaigns to &#8220;raise awareness&#8221; these&nbsp;days.</p>
<p>It is a rather sad indictment on our mainstream media though. Kony 2012 did not reveal any facts that have not been public knowledge for some time. But get a slick and somewhat emotionally manipulative video to go viral and media outlets are suddenly falling over themselves to show their moral cred by promoting it. But ...</p>
                <a class="readmore" href=".././thoughts-on-kony-2012.html">read more</a>
                <p>There are <a href=".././thoughts-on-kony-2012.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././why-im-a-climate-skeptic.html" rel="bookmark"
                           title="Permalink to Why I’m a Climate Skeptic">Why I&#8217;m a Climate&nbsp;Skeptic</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-02-07T00:00:00">
                Tue 07 February 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/politics.html">politics</a>. </p>
<p>tags: <a href=".././tag/politics.html">politics</a><a href=".././tag/climate-change.html">climate change</a></p>


</footer><!-- /.post-info -->
                <p>I&#8217;m going to attempt to explain my position on climate change, mostly for my own benefit, perhaps. The controversial and divisive nature of the climate change debate means that a staggering amount is written about it on a daily basis. What can an amateur like me hope to contribute that hasn&#8217;t been better covered elsewhere? I shall attempt to offer a useful perspective. But doing this right means doing it long, so sorry about&nbsp;that.</p>
<h1>My Road to&nbsp;&#8220;Denial&#8221;</h1>
<p>For most of my adult life, I have believed that human pollution of the atmosphere was causing destructive changes ...</p>
                <a class="readmore" href=".././why-im-a-climate-skeptic.html">read more</a>
                <p>There are <a href=".././why-im-a-climate-skeptic.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././xml-vs-streams.html" rel="bookmark"
                           title="Permalink to XML vs Streams"><span class="caps">XML</span> vs&nbsp;Streams</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2006-09-26T00:00:00">
                Tue 26 September 2006
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/lachlan-odea.html">Lachlan O'Dea</a>
        </address>
        
<p>In <a href=".././category/programming.html">programming</a>. </p>
<p>tags: <a href=".././tag/java.html">java</a><a href=".././tag/programming.html">programming</a></p>


</footer><!-- /.post-info -->
                <p>Ever get the feeling that <span class="caps">XML</span> sometimes makes things harder than they need to be? One of the problems that I and others have run into is that when parsing <span class="caps">XML</span> using <span class="caps">SAX</span> (or, in my case, using <span class="caps">JAXB</span> to unmarshall <span class="caps">XML</span>, which uses <span class="caps">SAX</span> under the hood) from an InputStream, the stream is always closed after the parsing is complete. This is surprising behaviour in Java, because you&#8217;re not supposed to close streams you don&#8217;t own. This can be a problem when <a href="http://weblogs.java.net/blog/kohsuke/archive/2005/07/socket_xml_pitf.html">using network sockets</a> or when you want to write two or more unrelated <span class="caps">XML</span> documents ...</p>
                <a class="readmore" href=".././xml-vs-streams.html">read more</a>
                <p>There are <a href=".././xml-vs-streams.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            </ol><!-- /#posts-list -->
            
                
            
            </section><!-- /#content -->
        
    


        <section id="extras" class="body">
        
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                        
                            <li><a href="http://www.scala-lang.org/">Scala</a></li>
                        
                            <li><a href="http://java.oracle.com/">Java</a></li>
                        
                            <li><a href="http://www.apple.com/">Apple</a></li>
                        
                            <li><a href="http://www.giantitp.com/comics/oots0001.html">The Order of the Stick</a></li>
                        
                        </ul>
                </div><!-- /.blogroll -->
        
        
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://quelgar.github.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            

                        
                            <li><a href="http://twitter.com/quelgar">Twitter</a></li>
                        
                            <li><a href="https://github.com/quelgar">GitHub</a></li>
                        
                        </ul>
                </div><!-- /.social -->
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->




<script type="text/javascript">
    var disqus_shortname = 'wisdom-eludes-me';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</body>
</html>